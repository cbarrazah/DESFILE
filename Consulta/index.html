<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Consulta de Sillas por Cédula</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <h2>Consulta de Sillas por Cédula</h2>

    <input type="text" id="cedulaInput" placeholder="Ingrese la cédula">
    <button onclick="buscarCedula()">Buscar</button>

    <pre id="resultado"></pre>

<script>
const excelURL = "https://raw.githubusercontent.com/cbarrazah/DESFILE/35e56dcc8bc43fa4a3f269379acfde7233dd0ea2/LISTADO.xlsx
";

let datos = [];

// Cargar Excel al iniciar
fetch(excelURL)
  .then(res => res.arrayBuffer())
  .then(buffer => {
      const excel = XLSX.read(buffer, { type: "array" });
      const primeraHoja = excel.Sheets[excel.SheetNames[0]];
      datos = XLSX.utils.sheet_to_json(primeraHoja);
      console.log("Datos cargados:", datos);
      console.log("Columnas detectadas:", Object.keys(datos[0]));
  });

function buscarCedula() {
    const cedula = document.getElementById("cedulaInput").value.trim();
    const resultado = datos.find(fila => fila.CEDULA == cedula);

    document.getElementById("resultado").textContent = resultado
        ? JSON.stringify(resultado, null, 2)
        : "No se encontró esta cédula.";
}
</script>
</body>
</html>
